#!/bin/bash

calc_tempdir() {
    prefix="${1:-filter-branch}"
    tempdir=$(
        mktemp -u -d --tmpdir=/dev/shm "$prefix".XXXXX ||
        mktemp -u -d --tmpdir "$prefix".XXXXX ||
        echo ".git-rewrite"
    )

    echo "using $tempdir as temporary directory" >&2
    echo "$tempdir"
}
# delete git-filter-branch backup refs.
delete_fb_backups() {
    git for-each-ref --format="%(refname)" ${1:-refs/original/} | \
    xargs --no-run-if-empty -n 1 git update-ref -d
}
